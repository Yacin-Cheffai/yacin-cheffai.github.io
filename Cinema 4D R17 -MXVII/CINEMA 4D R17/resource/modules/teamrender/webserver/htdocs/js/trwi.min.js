application=function(){function b(){this.version="2.01";this.config={debug:!1,timer:1E4,timeout:999999,cookiePrefix:"TRWI_",sessionTimout:.04,defaultSection:"monitor",language:navigator.language||navigator.userLanguage,loginRequired:$("#users").exists()};this.error=!1;this.user=this.lang_default=this.lang=null;this.actualSection={name:"none"};this.oldSection={name:"none"};this.navigation=this.notifications=null;this.sections={};this.sections.info=null;this.sections.jobs=null;this.sections.monitor=
null;this.sections.network=null;this.config.loginRequired&&(this.sections.login=null,this.sections.users=null,this.sections.logout=null);this.timer=null;this.runningUploads=0;window.app?utils.log("'application' can only be initialized once!"):window.app=this;app.init()}b.prototype.init=function(){$("#footer").find("#version").text("TR-WI "+app.version);app.notifications=new b.notifications;app.getLanguage(app.restoreSession)};b.prototype.launch=function(){app.sections.info=new b.section.info;app.sections.jobs=
new b.section.jobs;app.sections.network=new b.section.network;app.config.loginRequired&&(app.sections.users=new b.section.users,app.sections.logout=new b.section.logout);app.sections.monitor=new b.section.monitor;app.navigation=new b.navigation;app.user?(app.checkVisibility(),app.gotoSection(utils.getCurrentHashWithoutParams())):app.sections.users?app.gotoSection(app.sections.login.name):app.gotoSection(app.sections.monitor.name);app.notifications.handleAllExceptions();app.registerHandlers()};b.prototype.getLanguage=
function(a){utils.request("/languages",app,function(c){var d=app.config.language.toLowerCase();app.languages=c.languages;if(app.user&&app.user.language)d=app.user.language;else if(utils.getCookie("language"))d=utils.getCookie("language");else{c=0;for(var e=app.languages.length;c<e;c++){var b=app.languages[c];b.default_language&&(d=b.extensions)}}utils.request("/language?id="+d,app,function(c){app.lang=c.labels;"us"===d&&(app.lang_default=app.lang);null==app.lang_default?utils.request("/language?id=us",
app,function(c){app.lang_default=c.labels;"function"==typeof a&&a.call(app)},void 0,{cache:!0}):"function"==typeof a&&a.call(app)},void 0,{cache:!0})},void 0,{cache:!0})};b.prototype.restoreSession=function(){utils.translateElements($("body"));if(app.config.loginRequired){app.sections.login=new b.section.login;var a=utils.getCookie("username"),c=utils.getCookie("isadmin"),d=utils.getCookie("uuid"),e=utils.getCookie("language");a?utils.request("/verify",this,function(){app.user||(app.user={});a&&(app.user.username=
a);c&&(app.user.isadmin="true"===c);d&&(app.user.uuid=d);e&&(app.user.language=e);app.sections.login.showUserName();app.launch()},function(){app.launch()}):app.launch()}else app.user={},app.user.username="admin",app.user.isadmin=!0,app.launch()};b.prototype.storeSession=function(){app&&app.user&&(utils.setCookie("username",app.user.username,app.config.sessionTimout),utils.setCookie("isadmin",app.user.isadmin,app.config.sessionTimout),utils.setCookie("uuid",app.user.uuid,app.config.sessionTimout),
utils.setCookie("language",app.user.language,app.config.sessionTimout))};b.prototype.killSession=function(a){app.user=null;utils.removeCookie("username");utils.removeCookie("isadmin");utils.removeCookie("uuid");a&&window.location.reload()};b.prototype.gotoSection=function(a,c){if(app.actualSection.name!==a){var d=!1,e=null;app.user?(e=app.sections[app.config.defaultSection],$.each(app.sections,function(c,b){app.sections.logout&&a===app.sections.logout.name||b.hide();b.name===a?(e=b,d=!0):app.notifications.clear(b.name)})):
($("#content").find(".static").hide(),e=app.sections.users?app.sections.login:app.sections.jobs,d=!0);if(app.sections.logout&&a===app.sections.logout.name)app.sections.logout&&app.sections.logout.set();else if(app.oldSection=app.actualSection.name,app.actualSection=e,app.actualSection.initValues(),app.actualSection.set(),app.navigation&&app.navigation.setSection(app.actualSection.name),$("html, body").animate({scrollTop:0}),c||!d)location.hash="#/"+app.actualSection.name}};b.prototype.pull=function(a){app.user&&
app.actualSection&&"function"===typeof app.actualSection.pull&&app.actualSection.pull(a)};b.prototype.pump=function(a){a=a||app.config.timer;clearTimeout(this.timer);this.timer=setTimeout(function(){app.pull(!0)},a)};b.prototype.spin=function(a){var c=$("#navigation").find("#navbar-spinner img");c.removeClass("hidden");a?c.show().fadeIn(250):c.fadeOut(250)};b.prototype.registerHandlers=function(){app.handleResize();$(document).click(function(){app.storeSession()});$(document).on("input search",".filter",
function(){$(this).next().toggleClass("hidden",!(this.value&&0!==$(this).val().length))}).on("click",".btn_clear",function(a){$(this).addClass("hidden");$(this).prev().val("").trigger("search")});$(document).bind("drop dragover",function(a){a.preventDefault()});$(window).bind("beforeunload",function(){if(0<app.runningUploads)return 1<app.runningUploads?t("IDS_WEB_JOB_STILL_UPLOADING_MULTI",app.runningUploads):t("IDS_WEB_JOB_STILL_UPLOADING")})};b.prototype.handleResize=function(){var a;$(window).resize(function(){clearTimeout(a);
a=setTimeout(app.resize,15)});app.resize()};b.prototype.resize=function(){$.each(app.sections,function(a,d){d.resize()});var a=$("#navigation .navbar").height();$("#content").offset({top:a})};b.prototype.checkVisibility=function(){$.each(app.sections,function(a,c){"function"===typeof c.checkVisibility&&c.checkVisibility()})};return b}();
application.notifications=function(){function b(){this.$template=this.$container=null;this.initialized=!1;this.init()}b.prototype.init=function(){this.initialized?utils.log("'notifications' can only be initialized once!"):(this.initialized=!0,this.$container=$("#notifications").find(".static"),this.$container.show(),this.$template=$("#notifications").find("#notification_template"))};b.prototype.success=function(a,c,d,e){return this.message(a,"success",c,d,e)};b.prototype.info=function(a,c,d,e){return this.message(a,
"info",c,d,e)};b.prototype.warning=function(a,c,d,e){return this.message(a,"warning",c,d,e)};b.prototype.danger=function(a,c,d,e){return this.message(a,"danger",c,d,e)};b.prototype.message=function(a,c,d,e,b){c=c||"info";d=d||5E3;var g=$(this.$template.html());g.removeAttr("class");g.addClass("alert alert-"+c+" alert-dismissable");b&&(g.removeClass("alert-dismissable"),g.find("button").remove());g.find(".notification-span_message").text(a);e&&g.attr("id",e);var h=this.$container.append(g).children().last();
b||h.click(function(){$(this).fadeOut().remove()});h.disableSelection();h.fadeIn(500);0<d&&setTimeout(function(){h.fadeOut(500,function(){h.remove()})},d);return h};b.prototype.clear=function(a){a?this.$container.find("#"+a).remove():this.$container.html("")};b.prototype.handleAllExceptions=function(){var a=this;window.onerror=function(c,d,e){app.config.debug?a.danger(c,-1):app.error||a.danger(t("IDS_WEB_EXCEPTION"),-1);app.error=!0}};return b}();
application.navigation=function(){function b(){this.btns={};this.$toggle=null;this.initialized=!1;this.init()}b.prototype.init=function(){if(this.initialized)utils.log("'navigation' can only be initialized once!");else{this.initialized=!0;this.$toggle=$("#navigation").find("#navbar-toggle");var a=this;$("#navigation li a").each(function(){var c=$(this),d=app.sections[c.data("target")];c.attr("href","#/"+d.name);c.click(function(a){a.preventDefault();app.gotoSection(d.name,!app.sections.logout||d.name!==
app.sections.logout.name)});a.btns[d.name]=c});this.checkVisibility()}};b.prototype.checkVisibility=function(){var a=this;$.each(this.btns,function(c,d){$el=$(d);app.user&&!app.user.isadmin&&$el.text()===utils.capitalizeFirstChar(app.sections.users.name)&&$el.find("a").text("Profile");app.user?($el.show(),a.$toggle.show()):($el.hide(),a.$toggle.hide())})};b.prototype.setSection=function(a){$("#navigation").find(".navbar-nav li").removeClass("active");$.each(this.btns,function(c,d){if(c===a)return d.closest("li").addClass("active"),
!1});this.checkVisibility()};return b}();
application.section=function(){function b(){this.verbose_name="IDS_WEB_INFO";this.name="info";this.url="";this.linkInNavBar=!0;this.$container=null;this.templates={};this.initialized=!1}b.prototype.initValues=function(){};b.prototype.init=function(){this.initialized?utils.log("section '"+this.name+"' can only be initialized once!"):(this.initialized=!0,this.$container=$("#content").find("#"+this.name).find(" .static"),this.translate())};b.prototype.show=function(){this.$container.fadeIn()};b.prototype.hide=
function(){this.$container.hide()};b.prototype.resize=function(){};b.prototype.set=function(){this.show()};b.prototype.translate=function(){utils.translateElements(this.$container);$templates=this.$container.parent().find(".templates");$templates.exists()&&utils.translateElements($templates)};return b}();
application.ajaxSection=function(){function b(){application.section.call(this);this.requestHandler=this.data=this.rawDataCache=this.rawData=null}b.prototype=Object.create(application.section.prototype);b.prototype.set=function(){application.section.prototype.set.call(this);this.pull()};b.prototype.pull=function(){this.cancelPull();app.spin(!0);this.requestHandler=utils.request(this.url,this,[this.setData,this.lazyUpdate],this.pullError)};b.prototype.pullError=function(a,c,d,e){utils.throwHTTPError(a,
c,d,e);app.spin(!1);app.pump()};b.prototype.setData=function(a){app.spin(!1);this.rawDataCache=this.rawData;this.rawData=JSON.stringify(a);this.data=a};b.prototype.lazyUpdate=function(){this.rawData!==this.rawDataCache&&this.update();app.pump()};b.prototype.invalidateCache=function(){this.rawDataCache=null};b.prototype.cancelPull=function(a,c){this.requestHandler&&this.requestHandler.abort();a&&this.invalidateCache();c&&clearInterval(app.timer)};return b}();
application.listSection=function(){function b(){application.ajaxSection.call(this);this.$filterField=this.$selectionNone=this.$selectionAll=this.$selectionBtn=this.$selectionControl=this.$itemDetails=this.$listPane=this.selectedItem=null;this.selected=[];this.controlsVisible=this.hashSearched=!1}b.prototype=Object.create(application.ajaxSection.prototype);b.prototype.init=function(){application.ajaxSection.prototype.init.call(this);this.$listPane=this.$container.find("#"+this.name+"-list");this.$itemDetails=
this.$container.find("#"+this.name+"-details").hide();this.templates.$item=this.$container.parent().find(".templates").find("#"+this.name+"-item_template");this.$selectionControl=this.$container.find(".selection_control");this.$selectionBtn=this.$container.find(".select_btn");this.$selectionControlAll=this.$selectionControl.find(".select_all");this.$selectionControlNone=this.$selectionControl.find(".select_none");this.$filterField=this.$container.find(".scrollpane_control").find(".filter");this.$itemDetails.hide();
this.$selectionBtn.hide();this.$filterField.hide();var a=this;this.$filterField.bind("keyup search",function(){a.filter(a.$filterField.val())});this.$selectionControlAll.click(function(c){c.preventDefault();a.$listPane.find("input:visible").prop("checked",!0);a.setSelected()});this.$selectionControlNone.click(function(c){c.preventDefault();a.$listPane.find("input:visible").prop("checked",!1);a.setSelected()})};b.prototype.update=function(){var a=null===this.selectedItem;this.getSelectedItem(this.data[this.name]);
this.updateList();this.selectedItem&&(this.selectItem(this.selectedItem),this.$itemDetails.show(),this.updateDetails(this.selectedItem));a&&this.focusItem();this.resize();this.updateControls();this.handleCheckboxes()};b.prototype.updateList=function(){this.$listPane.html("");for(var a=0;a<this.data[this.name].length;a++){var c=this.data[this.name][a];this.newItemFromTemplate(c,c.name,"#/"+this.name+"/")}};b.prototype.updateDetails=function(){this.enableDetails()};b.prototype.selectItem=function(a){this.selectedItem=
a;this.updateDetails(a);this.focusDetails();if(a=this.getItemElementByUuid(a.uuid))this.$listPane.find(".panel").removeClass("panel-primary"),a.addClass("panel-primary")};b.prototype.getItemElementByUuid=function(a){var c=null;this.$listPane.find(".panel").each(function(d){if($(this).find("a").prop("id")===a)return c=$(this),!1});return c};b.prototype.getSelectedItem=function(a){var c=a[0];if(this.selectedItem)for(d=0;d<a.length;d++){if(this.selectedItem.uuid===a[d].uuid){c=a[d];break}}else if(!this.hashSearched){this.hashSearched=
!0;for(var d=0;d<a.length;d++)if(-1!==location.href.indexOf(a[d].uuid)){c=a[d];break}c&&(location.hash="#/"+this.name+"/"+c.uuid)}this.selectedItem=c};b.prototype.setSelected=function(){this.selected=[];var a=this;this.$listPane.find(".panel").each(function(c){$(this).find("input").prop("checked")&&(c=$(this).find("a").prop("href"),c=c.substring(c.lastIndexOf("/")+1),a.selected.push(c))});this.handleSelectionMenu()};b.prototype.restoreSelected=function(){for(var a=0;a<this.selected.length;a++){var c=
this.$listPane.find("a[href$='"+this.selected[a]+"']");c.exists()&&c.parents().eq(2).find("input").prop("checked",!0)}this.handleSelectionMenu()};b.prototype.clearSelected=function(){this.$listPane.find(".panel input:checked").prop("checked",!1);this.selected=[];this.handleSelectionMenu()};b.prototype.handleSelectionMenu=function(){if(this.controlsVisible){var a=this;0===this.selected.length?this.$selectionControl.find(".selected_action").addClass("disabled"):(this.$selectionControl.find(".selected_action").removeClass("disabled"),
this.$selectionControl.find(".selected_action > a").each(function(c){c=$(this).attr("class");stype=c.substr(c.lastIndexOf("_")+1,c.length);found=!1;a.$listPane.find("."+stype+"_able").each(function(c){c=$(this).find("a:first").attr("href");c=c.substring(c.lastIndexOf("/")+1);if(-1<a.selected.indexOf(c))return found=!0,!1});found||a.$container.find("."+c).parent().addClass("disabled")}))}};b.prototype.handleCheckboxes=function(){if(this.controlsVisible){this.restoreSelected();var a=this;this.$listPane.find("input").parent().click(function(){a.setSelected()})}else this.$listPane.find("input[type=checkbox]").remove(),
this.$listPane.find(".panel-title").css({"padding-right":"0px"})};b.prototype.filter=function(a){if(this.controlsVisible){a=a?a:this.$filterField.val();a=utils.cutdown(a);var c=this.$listPane.find(".panel").length;this.$listPane.find(".panel").each(function(){var c=$(this).find(".filterable"),e=c.text().toLowerCase();-1<utils.cutdown(e).indexOf(a)?c.parents(".panel").fadeIn(250):c.parents(".panel").hide()});0!==a.length?this.$filterField.css({"background-color":"#fcf8e3"}):this.$filterField.css({"background-color":"white"});
this.$listPane.find(".filterwarning").remove();this.$listPane.find(".panel:visible").exists()||this.$listPane.append("<div class='filterwarning alert alert-warning'>"+t("IDS_WEB_FILTER_WARNING",c)+"</div>")}};b.prototype.updateControls=function(){this.data&&this.data[this.name]&&0!==this.data[this.name].length?(this.controlsVisible=!0,this.$selectionBtn.show(),this.$filterField.show(),this.$itemDetails.show(),this.$filterField.trigger("search"),this.handleSelectionMenu()):(this.controlsVisible=!1,
this.$selectionBtn.hide(),this.$filterField.hide(),this.$itemDetails.hide())};b.prototype.disableItem=function(a){this.getItemElementByUuid(a).find(".btn").addClass("disabled");a===this.selectedItem.uuid&&this.disableDetails()};b.prototype.disableDetails=function(){};b.prototype.enableDetails=function(){};b.prototype.focusItem=function(){if(utils.testMediaBreakPoint("xs"))this.focusDetails();else{var a=0,c=this;this.$listPane.find(".panel").each(function(d){d=$(this).find("a").prop("href");d=d.substring(d.lastIndexOf("/")+
1);if(d===c.selectedItem.uuid)return a=$(this).offset().top,!1});a-=$("#navigation").find(".navbar ").height();this.$container.find(".scrollpane_control").exists()&&(a-=50);this.$listPane.scrollTop(a-10)}};b.prototype.focusDetails=function(){utils.testMediaBreakPoint("xs")&&$("html, body").scrollTop(this.$itemDetails.find(".panel-title").offset().top-70)};b.prototype.newItemFromTemplate=function(a,c,d){var e=$(this.templates.$item.html()),b=e.find(".title_link");b.text(c);b.attr("title",c);b.data("uuid",
a.uuid);b.attr("href",d+a.uuid);b.attr("id",a.uuid);this.$listPane.append(e);e.find("#"+a.uuid).click(function(a,c){return function(){a.selectItem(c);a.pull()}}(this,a));return e.children(":first")};b.prototype.selectedAction=function(a,c,d,b,f,g){var h=this;if(0!==this.selected.length){var l=[],k="";this.$listPane.find(a).each(function(a){a=$(this).find("a:first");var c=a.attr("id");-1<h.selected.indexOf(c)&&(k=a.text(),l.push(c))});0!=l.length&&(a=1<l.length?t(b):t(d,k),utils.confirm(a,function(a){if(a){a=
[];for(var d=0;d<l.length;d++)h.disableItem(l[d]),a.push(utils.request("/"+h.name+"/"+l[d]+c));h.cancelPull(!0);$.when(a).then(function(){var a=1<l.length?t(g):t(f,k);app.notifications.success(a,2E3);app.pull();h.clearSelected()})}}))}};b.prototype.resize=function(){if(utils.testMediaBreakPoint("xs"))this.$listPane.css("height","100%"),this.$itemDetails.css("height","100%"),this.$container.css("padding-bottom","60px");else{var a=$(window).height()-$("#footer").height()-$("#navigation").find(".navbar ").height();
this.$container.find(".scrollpane_control").exists()&&(a-=50);this.$listPane.css("height",a+"px");this.$itemDetails.css("height",a+"px");this.$container.css("padding-bottom","0px")}};return b}();
application.section.login=function(){function b(){application.section.call(this);this.name="login";this.verbose_name="IDS_WEB_LOGIN";this.url="/login";this.linkInNavBar=!1;this.$globalUserName=this.$formMessage=this.$formPassword=this.$formUsername=this.$formContainer=this.$form=null;this.init()}b.prototype=Object.create(application.section.prototype);b.prototype.init=function(){application.section.prototype.init.call(this);this.$form=this.$container.find("#login-form");this.$formContainer=this.$container.find("#login-container");
this.$formUsername=this.$form.find("#login-form_username");this.$formPassword=this.$form.find("#login-form_password");this.$formMessage=this.$form.find("#login-form_message");this.$globalUserName=$("#footer").find("#global_username");var a=this;this.$form.submit(function(c){c.preventDefault();0===a.$formUsername.val().length?(a.$formMessage.text(t("IDS_WEB_EMPTY_LOGIN_NAME")),a.$formMessage.fadeIn(),a.$formContainer.effect("shake",{distance:5,times:2},500)):(app.spin(!0),utils.requestPost(a.url,{username:a.$formUsername.val(),
password:$.md5(a.$formPassword.val())},this,function(c){app.spin(!1);a.$formMessage.hide();app.user||(app.user={});app.user.username=c.username;app.user.isadmin=c.isadmin;app.user.uuid=c.useruuid;app.user.language=c.language;app.storeSession();app.lang=c.labels;c=utils.getCurrentHashWithoutParams();var b=!1;if("login"===c||"logout"===c)c=app.sections.jobs.name,b=!0;app.checkVisibility();a.showUserName();app.gotoSection(c,b)},function(c){app.spin(!1);0===c.status?a.$formMessage.text(t("IDS_WEB_SERVERNOTREACHABLEOROFFLINE")):
a.$formMessage.text(t("IDS_WEB_WRONG_LOGIN_DATA"));a.$formMessage.fadeIn();a.$formContainer.effect("shake",{distance:5,times:2},500)}))})};b.prototype.set=function(){application.section.prototype.set.call(this);this.$globalUserName.text("").hide();this.$formPassword.val("");this.$formUsername.focus();this.$formMessage.text("").hide()};b.prototype.showUserName=function(){app.user&&(this.$globalUserName.removeClass("hidden").show(),this.$globalUserName.html(app.user.username+(app.user.isadmin?" (<span data-trs-translate='IDS_WEB_ADMINISTRATOR'>"+
t("IDS_WEB_ADMINISTRATOR")+"</span>)":"")))};return b}();
application.section.info=function(){function b(){application.ajaxSection.call(this);this.name="info";this.verbose_name="IDS_WEB_INFO";this.url="/info";this.linkInNavBar=!0;this.$drive=this.$applicationTotalBytes=this.$applicationUptime=this.$osup=this.$cpucount=this.$version=this.$os=this.$mem=null;this.init()}b.prototype=Object.create(application.ajaxSection.prototype);b.prototype.init=function(){application.ajaxSection.prototype.init.call(this);var a=this.$container.find(".list-group");this.templates.$infoItem=
$("#info-item_template");this.$servicename=$(this.templates.$infoItem.html());a.append(this.$servicename);this.$os=$(this.templates.$infoItem.html());a.append(this.$os);this.$version=$(this.templates.$infoItem.html());a.append(this.$version);this.$cpucount=$(this.templates.$infoItem.html());a.append(this.$cpucount);this.$mem=$(this.templates.$infoItem.html());a.append(this.$mem);this.$applicationTotalBytes=$(this.templates.$infoItem.html());a.append(this.$applicationTotalBytes);this.$applicationUptime=
$(this.templates.$infoItem.html());this.$applicationUptime.find(".txt").text(t("IDS_WEB_INFO_UPTIME"));a.append(this.$applicationUptime);this.$drive=$(this.templates.$infoItem.html());a.append(this.$drive);var c=this.name;$(".navbar-brand").click(function(a){a.preventDefault();app.gotoSection(c,!0)})};b.prototype.update=function(){this.$servicename.find(".badge").text(this.data.servicename);var a=utils.memoryToString(this.data.memory.totalBytes);this.$mem.find(".badge").text(a);a=utils.memoryToString(this.data.memory.applicationTotalBytes);
this.$applicationTotalBytes.find(".badge").text(a);this.$os.find(".badge").text(this.data.os);this.$cpucount.find(".badge").text(this.data.cpucount+"x"+this.data.cpuspeed/1E3+" GHz");a="CINEMA 4D R"+this.data.version.toString().substr(0,2)+"."+this.data.version.toString().substr(2);this.$version.find(".badge").text(a);this.$applicationUptime.find(".badge").text(utils.msToStr(this.data.applicationUptime));a=t("IDS_WEB_INFO_DRIVETXT",utils.memoryToString(this.data.drive.availableBytes),utils.memoryToString(this.data.drive.totalBytes));
a=this.$drive.find(".badge").text(a);switch(this.data.drive.status){case "critical":a.addClass("alert-danger");break;case "warning":a.addClass("alert-warning")}this.$applicationTotalBytes.find(".txt").text(t("IDS_WEB_INFO_RAMUSAGE"));this.$servicename.find(".txt").text(t("IDS_WEB_SERVICE_NAME"));this.$mem.find(".txt").text(t("IDS_WEB_INFO_RAM"));this.$os.find(".txt").text(t("IDS_WEB_INFO_OS"));this.$version.find(".txt").text(t("IDS_WEB_INFO_VERSION"));this.$cpucount.find(".txt").text(t("IDS_WEB_INFO_CPU"));
this.$drive.find(".txt").text(t("IDS_WEB_INFO_DRIVE",this.data.drive.drive))};return b}();
application.section.logout=function(){function b(){application.section.call(this);this.name="logout";this.verbose_name="IDS_WEB_LOGOUT";this.init()}b.prototype=Object.create(application.section.prototype);b.prototype.set=function(){application.section.prototype.set.call(this);var a=t("IDS_WEB_LOGOUT_CONFIRM");0<app.runningUploads&&(a+=" "+(1<app.runningUploads?t("IDS_WEB_JOB_STILL_UPLOADING_MULTI",app.runningUploads):t("IDS_WEB_JOB_STILL_UPLOADING")));utils.confirm(a,function(a){a&&utils.request("/logout",
this,function(){app.killSession(!0)},function(){app.killSession(!0)})})};return b}();
application.section.jobs=function(){function b(){application.listSection.call(this);this.resultassetscache=this.assetscache=enums.DISABLE;this.name="jobs";this.verbose_name="IDS_WEB_JOBS";this.url="/jobs";this.resultPreviewUrl=this.rawDetailsCache=this.selectedItemPrev=null;this.holdUpdate=!1;this.zipIntervall=null;this.zipIntervallTmpValue=100;this.$warning=this.$assets=this.$results=this.$log=this.$message=this.$tabs=this.$userName=this.$progress=this.$renderDateTime=this.$createDateTime=this.$previewImgNoScene=
this.$previewImgRefresh=this.$previewImg=this.$btnDelete=this.$btnControl=this.$btnAdd=this.$selectedDelete=this.$selectedStop=this.$selectedStart=null;this.$toUpload={};this.init()}b.prototype=Object.create(application.listSection.prototype);b.prototype.initValues=function(){this.resultassetscache=this.assetscache=enums.DISABLE};b.prototype.init=function(){application.listSection.prototype.init.call(this);this.templates.$unitBtns=$("#jobs-details-unitbtns_template");this.$selectedStart=this.$container.find(".select_action_start");
this.$selectedStop=this.$container.find(".select_action_stop");this.$selectedDelete=this.$container.find(".select_action_delete");this.$btnAdd=this.$container.find("#jobs-details_btn_add");this.$btnControl=this.$container.find("#jobs-details_btn_startstop");this.$btnDelete=this.$container.find("#jobs-details_btn_delete");this.$previewImg=this.$container.find("#jobs-details_preview_img");this.$previewImgRefresh=this.$container.find(".jobs-details_preview_btn_refresh");this.$previewImgLightbox=this.$container.find(".jobs-details_preview_btn_lightbox");
this.$previewImgNoScene=this.$container.find("#jobs-details_preview_nodefaultscene");this.$dateTimeCreate=this.$container.find("#jobs-details-datetime_create");this.$dateTimeStart=this.$container.find("#jobs-details-datetime_start");this.$position=this.$container.find("#jobs-details_position");this.$progress=this.$container.find("#jobs-details_progress");this.$dateTimeRenderTime=this.$container.find("#jobs-details-datetime_rendertime");this.$totalFrames=this.$container.find("#jobs-details_totalframes");
this.$userName=this.$container.find("#jobs-details_username");this.$tabs=this.$container.find("#jobdetails_nav");this.$log=this.$container.find("#jobs-details_console").find("textarea");this.$results=this.$container.find("#jobs-details_results");this.$assets=this.$container.find("#jobs-details_assets");this.$message=this.$container.find("#jobs-details_message");this.$filterTabContent=this.$container.find(".nav .filter");this.templates.$activeDivider=$("#jobs-item-active-divider_template");this.templates.$jobs_placeholder=
$("#jobs-placeholder_template");this.$previewImgRefresh.hide();this.$previewImg.parent().hide();this.$previewImgNoScene.show();this.addActions()};b.prototype.addActions=function(){var a=this;this.$btnAdd.click(function(){a.addJob()});this.$btnControl.click(function(){a.toggleJob(a.selectedItem,!(0<=a.selectedItem.id))});this.$btnDelete.click(function(){a.deleteJob(a.selectedItem)});this.$previewImgRefresh.click(function(){a.updatePreviewImage(a.selectedItem)});this.$previewImgLightbox.click(function(){$.colorbox({rel:"jobs-details",
scalePhotos:!0,maxWidth:"95%;",maxHeight:"95%;",html:$("#jobs-details_preview_img").clone().wrap("<div></div>").parent().html(),open:!0,onOpen:function(){a.cancelPull();a.holdUpdate=!0},onClosed:function(){a.holdUpdate=!1;a.pull()}})});this.$selectedStart.click(function(c){c.preventDefault();a.selectedAction(".start_able","/start","IDS_WEB_JOB_START_CONFIRM","IDS_WEB_JOB_START_CONFIRM_MULTIPLE","IDS_WEB_JOB_STARTING","IDS_WEB_JOB_STARTING_MULTIPLE")});this.$selectedStop.click(function(c){c.preventDefault();
a.selectedAction(".stop_able","/stop","IDS_WEB_JOB_STOP_CONFIRM","IDS_WEB_JOB_STOP_CONFIRM_MULTIPLE","IDS_WEB_JOB_STOPPING","IDS_WEB_JOB_STOPPING_MULTIPLE")});this.$selectedDelete.click(function(c){c.preventDefault();a.deleteSelected()});this.$listPane.sortable({axis:"y",items:".dragable",placeholder:"sortable-placeholder col-xs-1",start:function(c,d){a.holdUpdate=!0;$item=d.item;d.placeholder.height($item.innerHeight());d.placeholder.width($item.width())},stop:function(c,d){a.holdUpdate=!1;var b=
$(d.item),f=b.find("a").attr("href").substring(b.find("a").attr("href").lastIndexOf("/")+1),g=null,g=null;0<b.next().length?(g=b.next().find("a").attr("href").substring(b.next().find("a").attr("href").lastIndexOf("/")+1),utils.request("/jobs/"+f+"/move?insertbefore="+g,this,app.pull)):0<b.prev().length&&(g=b.prev().find("a").attr("href").substring(b.prev().find("a").attr("href").lastIndexOf("/")+1),utils.request("/jobs/"+f+"/move?insertafter="+g,this,app.pull))}});this.$filterTabContent.bind("keyup search",
function(){$this=$(this);var c=a.$container.find(".assetitem"),d=$this.val();0===d.length?c.show():(c.hide(),c.each(function(){0<=$(this).text().indexOf(d)&&$(this).show()}))});this.$container.find("a[data-toggle=tab]").on("show.bs.tab",function(c){$(c.target).data("filter")?a.$filterTabContent.prop("disabled",!1):a.$filterTabContent.prop("disabled",!0)});this.$listPane.sortable("disable")};b.prototype.invalidateCache=function(){application.listSection.prototype.invalidateCache.call(this);this.rawrawDetailsCache=
null};b.prototype.pull=function(a){this.cancelPull();app.spin(!0);var c="",c=this.selectedItem?this.selectedItem.uuid:"00000000-0000-0000-0000-000000000001",d=enums.DETAILSELECTOR_SELECTED,b=enums.DETAILSELECTOR_NONE,f=this.assetscache,g=this.resultassetscache;if(void 0===a||!1==a)g=f=!1;this.requestHandler=utils.request(this.url+"?assets="+d+"&results="+d+"&log="+d+"&rdata="+b+"&rgroups="+b+"&jobid="+c+"&assetscache="+f+"&resultassetscache="+g,this,[this.setData,this.lazyUpdate],this.pullError)};
b.prototype.updateList=function(){if(!this.holdUpdate){var a=this;this.$listPane.html("");for(var c=0,d=0;d<this.data[this.name].length;d++){var b=this.data[this.name][d],f=this.newItemFromTemplate(b,b.name,"#/jobs/");f.find("#"+b.uuid).off().click(function(a,c){return function(){a.assetscache=enums.DISABLE;a.resultassetscache=enums.DISABLE;a.selectItem(c)}}(this,b));var g=f.find(".message"),h=f.find(".user"),l=f.find(".position"),k=f.find(".job_progress_bar .progress-bar"),n=f.find(".job_progress_bar .progress-bar span");
0<b.statusshort.length&&g.text(t("IDS_WEB_JOB_"+b.statusshort.toUpperCase()));g.removeClass();g.addClass("message");var m=utils.getJobContextualColor(b);m?g.addClass("text-"+m):g.addClass("text-info");app.user.isadmin?h.text(b.user):h.parent().empty();b.id?l.text(b.id):(l.parent().parent().remove(),h.parent().removeClass("col-lg-4").addClass("col-lg-6"));k.css("width",Math.min(b.progressgui,100)+"%");k.removeClass();k.parent().removeClass();k.parent().addClass("progress");k.addClass("progress-bar");
"progress"===b.statusshort||"assemble"===b.statusshort?k.css("transition-duration","3s"):k.css("transition-duration","0s");"info"===m?(k.parent().addClass("active"),"pending"!==b.statusshort&&k.parent().addClass("progress-striped")):m&&k.addClass("progress-bar-"+m);n.text(String(100*b.progress).substr(0,4)+"%");f.find("input").click(function(){a.setSelected()});g=f.find(".controlbutton");(h=0<=b.id)?(c++,g.find(".btn_label").html(" "+t("IDS_WEB_JOB_STOP")),g.find(".glyphicon").removeClass("glyphicon-play").addClass("glyphicon-stop")):
(f.find(".glyphicon-sort").hide(),g.find(".btn_label").html(" "+t("IDS_WEB_JOB_START")),g.find(".glyphicon").removeClass("glyphicon-stop").addClass("glyphicon-play"),"prepare"===b.statusshort.toLowerCase()&&g.addClass("disabled"));g.click(function(c,d){return function(){a.selectItem(c);a.toggleJob(c,!d)}}(b,h));h?(f.parent().addClass("dragable"),f.addClass("stop_able")):(f.addClass("inactive"),f.addClass("delete_able"),f.addClass("start_able"))}1>=c?(this.$listPane.sortable("disable"),this.$listPane.find(".glyphicon-sort").hide(),
this.$listPane.find(".panel-title").css({"padding-right":"26px"})):(this.$listPane.sortable("enable"),this.$listPane.find(".panel-title").css({"padding-right":"46px"}));$("div > div.start_able").first().parent().before(this.templates.$activeDivider);this.$listPane.disableSelection();this.$listPane.find(".panel.stop_able").bind("mousedown",function(){var c=$(this);c.css("cursor","pointer");-1!==a.$listPane.find("div:not(:first-child) .panel").index(this)?a.$listPane.sortable("enable"):(a.$listPane.sortable("disable"),
c.css("cursor","not-allowed"))});this.$listPane.find(".panel.stop_able").bind("mouseup mouseleave",function(){$(this).css("cursor","pointer")});application.listSection.prototype.updateControls.call(this)}};b.prototype.updateDetails=function(a){if(!this.holdUpdate){var c=JSON.stringify(a);if(this.rawDetailsCache!==c){this.rawDetailsCache=c;application.listSection.prototype.updateDetails.call(this);var d=this;this.$btnDelete.removeClass("disabled");this.$btnControl.removeClass("disabled");0<=a.id?(this.$btnControl.find(".btn_label").html(" <span data-trs-translate='IDS_WEB_JOB_STOP'>"+
t("IDS_WEB_JOB_STOP")+"</span>"),this.$btnControl.find(".glyphicon").removeClass("glyphicon-play").addClass("glyphicon-stop"),this.$btnDelete.addClass("disabled")):("prepare"===a.statusshort&&(this.$btnControl.addClass("disabled"),this.$btnDelete.addClass("disabled")),this.$btnControl.find(".btn_label").html(" <span data-trs-translate='IDS_WEB_JOB_START'>"+t("IDS_WEB_JOB_START")+"</span>"),this.$btnControl.find(".glyphicon").removeClass("glyphicon-stop").addClass("glyphicon-play"));this.$itemDetails.addClass();
this.$itemDetails.find(".panel-title").text(t("IDS_WEB_JOBS_DETAILS")+": "+a.name);this.$dateTimeCreate.text(""!==a.datetime_create?a.datetime_create:"-");this.$dateTimeStart.text(""!==a.datetime_start?a.datetime_start:"-");this.$progress.text(String(100*a.progress).substr(0,4)+"%");0<=a.id?(this.$position.text(a.id),$("#jobs-details_position-li").show()):$("#jobs-details_position-li").hide();a.framesrel===a.framesabs?this.$totalFrames.text(0<a.framesabs?t("IDS_WEB_JOB_FRAMESALL",a.framesabs):"-"):
this.$totalFrames.text(0<a.framesabs?t("IDS_WEB_JOB_FRAMES",a.framesrel,a.framesabs):"-");this.$dateTimeRenderTime.text(0<a.datetime_rendertime?utils.msToStr(1E3*a.datetime_rendertime):"-");this.$userName.text(a.user);this.$message.text(t("IDS_WEB_JOB_"+a.statusshort.toUpperCase()));this.$message.removeClass();(c=utils.getJobContextualColor(a))?this.$message.addClass("text-"+c):this.$message.addClass("text-info");if(a.current_logs){$("#jobs-details_logs-count").text(a.current_logs.length);for(var c=
"",b=0;b<a.current_logs.length;b++)c+=a.current_logs[b]+"\n";this.$log.val(c);this.$log.scrollTop(9999999)}d.$assets.find(".uploaditem[data-jobuuid!="+d.selectedItem.uuid+"]").hide();d.$assets.find(".uploaditem[data-jobuuid="+d.selectedItem.uuid+"]").show();if(a.assets&&a.assets_modified)if(this.$assets.children().each(function(a){a=$(this);a.data("upload")||a.remove()}),$("#jobs-details_assets-count").text(a.assets.length),0===this.$assets.find("#uploadControls").length&&(c="<label for='fileselector' class='uploadlabel btn btn-xs btn-primary'><input type='file' name='fileselector' id='fileselector' multiple class='file_selector'></input><span class='glyphicon glyphicon-plus'></span> "+
t("IDS_WEB_JOB_ASSET_SELECT")+"</label>",b="<a href='#' class='btn btn-xs btn-default' id='upload_all'><span class='glyphicon glyphicon-floppy-open'></span> "+t("IDS_WEB_JOB_ASSET_UPLOAD_ALL")+"</a>",c=$("<div id='uploadControls' class='list-group-item list-group-item-info' upload='1'><div class='btn-group col-md-12'>"+c+b+"</div></div>"),this.$assets.prepend(c),$("#fileselector").width($("#jobs .uploadlabel").outerWidth()),this.$assets.find("input").change(function(){d.buildUploadList(a,this.files);
$(this).val(null)}),this.$assets.find("#upload_all").click(function(){d.uploadAllFiles(d.selectedItem.uuid,!0)}),this.checkUploadAllBtn()),0<a.assets.length){c=[];for(b=0;b<a.assets.length;b++)if(!a.assets[b].imagesequence&&utils.endsWith(a.assets[b].name,"c4d")){var f=a.assets.splice(b--,1)[0];c.push(f)}a.assets=c.concat(a.assets);b=$("<button type='button' class='btn btn-xs btn-default btn-master-scene' style='padding-top:4px; margin-left:5px;'> "+t("IDS_WEB_JOB_ASSET_SET_DEFAULT")+"</button>");
f="";for(c=0;c<a.assets.length;c++){var g=a.defaultscenename===a.assets[c].relpath,h="<div class='assetitem-left col-md-8'>";a.assets[c].imagesequence?h+=a.assets[c].imagesequenceprefix+" <span class='badge badge-default badge-light'>"+a.assets[c].imagesequencefrom+".."+a.assets[c].imagesequenceto+"</span> "+a.assets[c].imagesequenceappendix:(h+=a.assets[c].name,"c4d"===a.assets[c].name.substr(a.assets[c].name.length-3).toLowerCase()&&(h=g?h+" <span class='glyphicon glyphicon-star' style='margin-left:5px;'></span>":
h+b.attr("data-file",a.assets[c].name).attr("data-path",a.assets[c].relpath)[0].outerHTML));h+="</div>";h+="<button type='button' class='btn btn-sm btn-danger glyphicon glyphicon-trash pull-right delete-asset' data-file='"+a.assets[c].relpath+"' data-defaultscene='"+g+"' data-file='"+a.assets[c].name+"' data-path='"+a.assets[c].relpath+"'></button>";h+="<span class='badge badge-default pull-right badge-size'>"+utils.memoryToString(a.assets[c].size)+"</span>";a.assets[c].imagesequence&&(h+="<span class='badge badge-default badge-size'>"+
(a.assets[c].imagesequenceto-a.assets[c].imagesequencefrom+1)+" Files</span>");f+="<div class='list-group-item list-group-item-custom assetitem'>"+h+"</div>"}this.$assets.append(f);$(".btn-master-scene").click(function(a){var c=$(a.target).data("file");a=$(a.target).data("path");d.setAsDefaultScene(c,a)});$(".delete-asset").click(function(a){var c=$(a.target).data("file"),b=$(a.target).data("path");d.deleteAsset(c,b);$(a.target).data("defaultscene")&&d.updatePreviewImage(d.selectedItem)})}else this.$assets.append("<div class='list-group-item list-group-item-warning list-group-item-custom col-md-12'><strong>"+
t("IDS_WEB_JOB_ASSET_NOT_AVAILABLE")+"</strong></div>");b="";if(a.resultassets&&a.resultassets_modified){this.$results.empty();$("#jobs-details_results-count").text(a.resultassets.length);this.resultPreviewUrl=null;if(0<a.resultassets.length){f=null;if(0===this.$results.find("#clearresults").length)var c="<a href='#' id='preparezip' class='btn btn-xs btn-primary'><span class='glyphicon glyphicon-time'></span> "+t("IDS_WEB_JOB_RESULT_ZIP_PREPARE")+"</a>",l="<div style='width: 100%; padding-top:0px; margin-bottom: 5px; margin-top: 5px; display: none;' class='progress progress-striped active'><div class='progress-bar' role='progressbar' style='width: "+
this.zipIntervallTmpValue+"%; padding-top: 0px; '>"+t("IDS_WEB_JOB_RESULT_ZIP_IN_PROGRESS")+"</div></div>",h="<a href='#' id='clearresults' class='btn btn-xs btn-danger'><span class='glyphicon glyphicon-trash'></span> "+t("IDS_WEB_JOB_RESULT_CLEAR")+"</a>",f=$("<div class='list-group-item list-group-item-info list-group-item-custom'><div class='btn-group col-md-3'>"+c+"</div><div class='col-md-5'>"+l+"</div><div class='col-md-4'><div class='btn-group pull-right'>"+h+"</div></div></div>");$();g=!1;
for(c=0;c<a.resultassets.length;c++)if(h=a.resultassets[c].name,"progress"!==h||this.zipIntervall){var k="<div class='list-group-item list-group-item-custom assetitem'><div class='col-md-8 resultname'><a href='#PREVIEW_URL#' class='btn btn-xs btn-default lightbox'><span class='glyphicon glyphicon glyphicon-picture'></span></a>#RESULTNAME#</div><div class='btn-group pull-right'><button type='button' class='btn btn-xs btn-danger glyphicon glyphicon-trash' data-file='#DATA_FILE#'></button><a href='#DOWNLOAD_URL#' class='btn btn-xs glyphicon glyphicon-save btn-primary'></a></div><span class='badge badge-default pull-right badge-size'>#SIZE#</span></div>".replace("#RESULTNAME#",
h),k=k.replace("#SIZE#",utils.memoryToString(a.resultassets[c].size)),k=k.replace("#DATA_FILE#",h),k=k.replace("#DOWNLOAD_URL#","/jobs/"+a.uuid+"/result/get/"+encodeURIComponent(a.resultassets[c].name)),n=h.substr(h.lastIndexOf(".")+1).toLowerCase();"mov"!==n&&"avi"!==n&&"zip"!==n?(this.resultPreviewUrl="/jobs/"+a.uuid+"/result/get/"+encodeURIComponent(h)+"?returnjpg=1",k=k.replace("#PREVIEW_URL#",this.resultPreviewUrl)):k=k.replace("<a href='#PREVIEW_URL#' class='btn btn-xs btn-default lightbox'><span class='glyphicon glyphicon glyphicon-picture'></span></a>",
"");b=utils.endsWith(h,".zip")?k+b:b+k}else d.$results.find(".progress").show(),this.zipIntervall=setInterval(function(){utils.request("/jobs/"+a.uuid+"/result/zip/progress",this,function(a){d.$results.find(".progress-bar").css("width",a.progress+"%");d.zipIntervallTmpValue=a.progress;"100"===String(a.progress)&&(clearInterval(d.zipIntervall),d.zipIntervall=null,d.zipIntervallTmpValue=100,d.$results.find(".progress").hide())},function(){clearInterval(d.zipIntervall);d.zipIntervall=null;d.zipIntervallTmpValue=
100})},app.config.timer),g=!0;f&&(c="<a href='#' id='preparezip' class='btn btn-xs btn-primary'><span class='glyphicon glyphicon-time'></span> "+t("IDS_WEB_JOB_RESULT_ZIP_PREPARE")+"</a>",h="<a href='#' id='clearresults' class='btn btn-xs btn-danger'><span class='glyphicon glyphicon-trash'></span> "+t("IDS_WEB_JOB_RESULT_CLEAR")+"</a>",c=$("<div class='list-group-item list-group-item-info list-group-item-custom assetitem row'><div class='btn-group col-md-3'>"+c+"</div><div class='col-md-5'>"+l+"</div><div class='col-md-4'><div class='btn-group pull-right'>"+
h+"</div></div></div>"),this.$results.prepend(f),this.$results.find("#preparezip").click(function(){$(this).addClass("disabled");d.prepareZipArchive()}),this.$results.find("#clearresults").click(function(){d.clearAllResults()}));g?d.$results.find(".progress").show():(clearInterval(this.zipIntervall),d.zipIntervall=null,d.zipIntervallTmpValue=100,d.$results.find(".progress").hide())}else b+="<div class='col-md-12 list-group-item list-group-item-custom list-group-item-warning'><strong>"+t("IDS_WEB_JOB_RESULT_NOT_AVAILABLE")+
"</div>";l=$(b);this.$results.append(l);l.find("button").click(function(a){a=$(a.target).data("file");d.deleteResult(a)});l.find(".lightbox").colorbox({rel:"Results",photo:!0,scalePhotos:!0,maxWidth:"95%;",maxHeight:"95%;",onOpen:function(){d.cancelPull();d.holdUpdate=!0},onClosed:function(){d.holdUpdate=!1;d.pull()}})}a.assets&&a.resultassets?(this.selectedItemPrev!==this.selectedItem&&(this.selectedItemPrev=this.selectedItem,this.updatePreviewImage(a)),this.$tabs.fadeTo(200,1),this.$tabs.find("btn").removeClass("disabled"),
this.resultassetscache=this.assetscache=enums.ENABLE):(this.$tabs.find("btn").addClass("disabled"),this.$tabs.fadeTo(200,.5),this.disableDetails(),this.updatePreviewImage(a),this.pull())}}};b.prototype.updatePreviewImage=function(a){var c=new Date;a=a?"/jobs/"+a.uuid+"/documentpreview?"+c.getTime():"";var d=this;this.$previewImg.error(function(){d.$previewImgRefresh.hide();d.$previewImg.parent().hide();d.$previewImgNoScene.show()}).load(function(){d.$previewImgRefresh.show();d.$previewImg.parent().show();
d.$previewImgNoScene.hide()}).attr("src",a)};b.prototype.addJob=function(){var a=this;utils.prompt(t("IDS_WEB_JOB_NEW_QUESTION"),function(c){if(c){var d=$.trim(c);if(0===d.length)app.notifications.danger(t("IDS_WEB_JOB_NEW_NAME_NOT_EMPTY"));else if(d.match(/^[a-zA-Z0-9_. -]+$/)){for(c=0;c<a.data.jobs.length;c++)if(utils.cutdown(a.data.jobs[c].name)===utils.cutdown(d)){app.notifications.danger(t("IDS_WEB_JOB_NEW_EXISTS",d));return}utils.requestPost("/jobs/create",{jobname:d},this,function(){a.selectedItem=
null;app.notifications.success(t("IDS_WEB_JOB_CREATED",d),2E3);app.pull()})}else app.notifications.danger(t("IDS_WEB_JOB_NEW_RESTRICTION"))}})};b.prototype.toggleJob=function(a,c){var d=this;c?(d.disableItem(a.uuid),d.cancelPull(!0),app.notifications.success(t("IDS_WEB_JOB_STARTING",a.name),2E3),utils.request("/jobs/"+a.uuid+"/start",this,app.pull)):utils.confirm(t("IDS_WEB_JOB_STOP_CONFIRM",a.name),function(c){c&&(d.disableItem(a.uuid),d.cancelPull(!0),app.notifications.success(t("IDS_WEB_JOB_STOPPING",
a.name),2E3),utils.request("/jobs/"+a.uuid+"/stop",this,app.pull))})};b.prototype.deleteJob=function(a){var c=this;utils.confirm(t("IDS_WEB_JOB_DELETE_CONFIRM",c.selectedItem.name),function(d){d&&(c.disableItem(a.uuid),c.cancelPull(!0),app.notifications.success(t("IDS_WEB_JOB_DELETING",a.name),2E3),utils.request("/jobs/"+a.uuid+"/delete",this,app.pull))})};b.prototype.buildUploadList=function(a,c){var d=this.$assets.find("#uploadControls:nth-child(1)"),b=null,f=null,g=0,h=$("<div class='col-md-4'></div>");
h.css("padding-right","0px");for(var l=0;l<c.length;l++)if(b=c[l],4294967296<b.size)app.notifications.danger(t("IDS_WEB_UPLOADEDFILETOOBIG",b.name,4));else{var k=!1;0<this.$assets.find("[data-file='"+utils.cutdown(b.name)+"']").length&&(k=!0,f=b.name);for(var n=!1,m=0;m<a.assets.length;m++)if(a.assets[m].name&&utils.cutdown(a.assets[m].name)===utils.cutdown(b.name)){n=!0;break}if(k||n)f=b.name;else{var k=$("<div class='progress col-md-3'><div class='progress-bar' role='progressbar'><span>0%</span></div></div>"),
n=$("<button type='button' class='btn btn-xs btn-danger hidden'><span class='glyphicon glyphicon-stop'></span> "+t("IDS_WEB_JOB_ASSET_CANCEL")+"</button>"),m=$("<button type='button' class='btn btn-xs btn-danger cancelbtn'><span class='glyphicon glyphicon glyphicon-floppy-remove'></span> "+t("IDS_WEB_JOB_ASSET_REMOVE")+"</button>"),r=$("<button type='button' class='btn btn-xs btn-default uploadbtn'><span class='glyphicon glyphicon-floppy-open'></span> "+t("IDS_WEB_JOB_ASSET_UPLOAD")+"</button>"),
p=$("<div data-jobuuid='"+a.uuid+"' data-upload='true' class='list-group-item uploaditem'><span id='filename' class='col-md-5'>"+c[l].name+"</span></div>");p.append(k);var q=$("<div class='btn-group pull-right'></div>");p.append(q);q.append(r);q.append(n);q.append(m);q.wrap(h);d.after(p);m.click(function(a,c){return function(){c.remove();a.checkUploadAllBtn()}}(this,p));r.click(function(a,c,d,b,e,f,g,h){return function(){a.uploadFile(c,d,e,b.children(":first"),f,g,h)}}(this,b,a.uuid,k,p,r,n,m));g++}}f&&
app.notifications.danger(t("IDS_WEB_JOB_ASSET_FILE_EXISTS",f));this.checkUploadAllBtn()};b.prototype.uploadFile=function(a,c,d,b,f,g,h){var l=this,k=new FormData;k.append("file",a);g.show();f.hide();h.hide();b.removeClass("progress-bar-danger");this.checkUploadAllBtn();var n=$.ajax({type:"POST",processData:!1,dataType:"json",cache:!1,url:"/jobs/"+c+"/asset/add",data:k,contentType:!1,xhr:function(){var c=new window.XMLHttpRequest;c.upload.addEventListener("progress",function(c){if(c.lengthComputable){var d=
c.loaded/c.total;b.css("width",100*d+"%");c.loaded===c.total&&"zip"===a.name.substr(a.name.lastIndexOf(".")+1).toLowerCase()?b.find("span").text(t("IDS_WEB_JOB_ASSET_UNZIPPING")):b.find("span").text(Math.round(1E4*d)/100+"%")}},!1);return c},complete:function(a){0===!a.status&&f.hide();f.removeClass("disabled");g.hide();h.show();l.checkUploadAllBtn();app.runningUploads--;l.uploadAll&&0==app.runningUploads&&(f.removeClass("toUpload"),l.uploadAllFiles(c))},success:function(a){app.pull();l.updatePreviewImage(l.selectedItem);
d.remove()},error:function(a){b.addClass("progress-bar-danger");b.text(utils.HTML2Text(a.responseJSON&&a.responseJSON.error?a.responseJSON.error:a.responseText));f.show();0===!a.status&&g.off("click").click(function(){d.remove()})}});app.runningUploads++;g.on("click").click(function(){n.abort();f.show();h.show();g.hide()})};b.prototype.uploadAllFiles=function(a,c){this.uploadAll=!0;a&&c&&(this.$toUpload[a]=this.$assets.find(".uploaditem[data-jobuuid="+a+"] .uploadbtn:visible"),this.$toUpload[a].addClass("toUpload"));
this.$toUpload[a].each(function(){$(this).click();if(10<app.runningUploads)return!1});0===this.$assets.find(".uploaditem[data-jobuuid="+a+"] .uploadbtn.toUpload").length&&(this.uploadAll=!1,delete this.$toUpload[a])};b.prototype.setAsDefaultScene=function(a,c){var d=this;utils.confirm(t("IDS_WEB_JOB_ASSET_SET_DEFAULT_CONFIRM",a),function(b){b&&utils.requestPost("/jobs/"+d.selectedItem.uuid+"/setdefaultscenename",{filename:c},app,function(){app.notifications.success(t("IDS_WEB_JOB_ASSET_SET_DEFAULT_CHANGED",
a),2E3);d.updatePreviewImage(d.selectedItem);app.pull()})})};b.prototype.checkUploadAllBtn=function(){this.$assets.find(".uploadbtn:visible").exists()?this.$assets.find("#upload_all").show():this.$assets.find("#upload_all").hide()};b.prototype.deleteAsset=function(a,c){var d=this;utils.confirm(t("IDS_WEB_JOB_ASSET_DELETE_CONFIRM",a),function(b){b&&(app.notifications.success(t("IDS_WEB_JOB_ASSET_DELETE_PROCESS",a),2E3),utils.requestPost("/jobs/"+d.selectedItem.uuid+"/asset/delete",{filename:c},app,
function(){d.updatePreviewImage(d.selectedItem);app.pull()}))})};b.prototype.deleteResult=function(a){var c=this;utils.confirm(t("IDS_WEB_JOB_RESULT_DELETE_CONFIRM",a),function(d){d&&(app.notifications.success(t("IDS_WEB_JOB_RESULT_DELETE_PROCESS",a),2E3),utils.requestPost("/jobs/"+c.selectedItem.uuid+"/result/delete",{filename:a},app,app.pull))})};b.prototype.prepareZipArchive=function(a){utils.request("/jobs/"+this.selectedItem.uuid+"/result/zip",this,app.pull);this.$results.find(".progress").show()};
b.prototype.clearAllResults=function(a){var c=this;utils.confirm(t("IDS_WEB_JOB_RESULT_CLEAR_ALL"),function(a){a&&(app.notifications.success(t("IDS_WEB_JOB_RESULT_CLEAR_ALL_PROCESS",c.selectedItem.name),2E3),utils.request("/jobs/"+c.selectedItem.uuid+"/clear",app,app.pull))})};b.prototype.deleteSelected=function(){var a=this;if(0!==this.selected.length){var c=[],d="",b=!1;a.$listPane.find(".isactive").each(function(c){c=$(this).find("a:first").attr("id");if(-1<a.selected.indexOf(c))return b=!0,!1});
a.$listPane.find(".delete_able").each(function(b){b=$(this).find("a:first");var e=b.attr("id");-1<a.selected.indexOf(e)&&(d=b.text(),c.push(e))});if(0!=c.length){var f=1<c.length?t("IDS_WEB_JOB_DELETE_CONFIRM_MULTIPLE"):t("IDS_WEB_JOB_DELETE_CONFIRM",d);utils.confirm(f,function(f){if(f){b&&app.notifications.danger(t("IDS_WEB_JOB_STOP_BEFORE_DELETE"));f=[];for(var h=0;h<c.length;h++)a.disableItem(c[h]),f.push(utils.request("/jobs/"+c[h]+"/delete"));a.cancelPull(!0,!0);$.when(f).then(function(){var a=
1<c.length?t("IDS_WEB_JOB_DELETING_MULTIPLE"):t("IDS_WEB_JOB_DELETING",d);app.notifications.success(a,2E3);app.pull()})}})}}};return b}();
application.section.network=function(){function b(){application.listSection.call(this);this.verbose_name="IDS_WEB_NETWORK";this.name="network";this.url="/network";this.$restartServerBtn=this.$restartClientsBtn=this.$controls=this.$restartBtn=this.$infoBtn=this.$logBtn=this.$logCounter=this.$log=this.$status=this.$description=this.$plugins=this.$consoleNetwork=this.$selectedRestart=null;this.init()}b.prototype=Object.create(application.listSection.prototype);b.prototype.init=function(){application.listSection.prototype.init.call(this);
this.$selectedRestart=this.$container.find(".select_action_restart");this.$consoleNetwork=this.$itemDetails.find("#network-details_console").find("textarea");this.$plugins=this.$itemDetails.find("#network-details_plugins");this.$description=this.$itemDetails.find("#network-details_description");this.$status=this.$itemDetails.find("#network-details_status");this.$log=this.$itemDetails.find("#network-details_log_container");this.$logCounter=this.$itemDetails.find("#network-details_log_count");this.$logBtn=
this.$itemDetails.find("#network-details_log_btn");this.$infoBtn=this.$container.find("#network-details_btn_info");this.$controls=this.$itemDetails.find("#network-details_controls");this.$restartBtn=this.$controls.find("#network-details_restart_btn");this.$restartClientsBtn=this.$container.find("#network-controls_restartall");this.$restartServerBtn=this.$container.find("#network-controls_restarserver");this.templates.$activeDivider=$("#network-item-active-divider_template");this.addActions()};b.prototype.addActions=
function(){var a=this;this.$infoBtn.click(function(){app.gotoSection(app.sections.info.name)});this.$restartClientsBtn.click(function(){a.restartClients()});this.$restartServerBtn.click(function(){a.restartServer()});this.$restartBtn.click(function(){a.restartClient()});this.$selectedRestart.click(function(c){c.preventDefault();a.selectedAction(".restart_able","/restart","IDS_WEB_NETWORK_RESTART_CLIENT_CONFIRM","IDS_WEB_NETWORK_RESTART_SELECTED_CONFIRM_MULTIPLE","IDS_WEB_NETWORK_RESTART_CLIENT_PROGRESS",
"IDS_WEB_NETWORK_RESTART_SELECTED_PROGRESS_MULTIPLE")})};b.prototype.updateList=function(){var a=this;a.$listPane.html("");for(var c=0;c<a.data[this.name].length;c++){var d=a.data[this.name][c],b=a.newItemFromTemplate(d,d.name,"#/network/");b.find(".message").text(t("IDS_WEB_NETWORK_"+d.statusshort.toUpperCase()));b.find(".address").text(d.address);!1==d.selected&&!1==d.islocal&&b.addClass("excluded");app.user.uuid!==d.uuid&&b.addClass("delete_able");"machinestate_offline"!==d.status&&a.$listPane.children().last().addClass("restart_able")}$("div > div.excluded").first().parent().before(this.templates.$activeDivider);
app.user.isadmin||a.$listPane.find("input:checkbox").hide();a.$listPane.find("input").click(function(){a.setSelected()})};b.prototype.updateDetails=function(a){application.listSection.prototype.updateDetails.call(this);this.$itemDetails.find(".panel-title").text(t("IDS_WEB_NETWORK_DETAILS")+": "+a.name);this.$status.text(t("IDS_WEB_NETWORK_"+a.statusshort.toUpperCase()));this.$description.text(a.description);this.$plugins.text(a.plugins);"machinestate_offline"===a.status?this.$plugins.parents(".list-group-item").hide():
this.$plugins.parents(".list-group-item").show();if(app.user.isadmin){this.$logCounter.text(a.current_logs.length);for(var c="",b=0;b<a.current_logs.length;b++)c+=a.current_logs[b]+"\n";this.$consoleNetwork.val(c);this.$consoleNetwork.scrollTop(9999999);this.$logBtn.attr({target:"_blank",href:"/network/"+a.uuid+"/log?logcount=50000"});0===a.current_logs.length?this.$logBtn.addClass("disabled"):this.$logBtn.removeClass("disabled");"machinestate_offline"===a.status?(this.$log.hide(),this.$logBtn.parent().hide(),
this.$controls.hide()):(this.$log.show(),this.$logBtn.parent().show(),this.$controls.show())}};b.prototype.checkVisibility=function(){app.user.isadmin||(this.$selectionBtn.remove(),this.$filterField.remove(),this.$logBtn.parent().remove(),this.$controls.remove(),this.$restartClientsBtn.remove(),this.$restartServerBtn.remove(),this.$log.remove(),this.$listPane.find("input:checkbox").hide())};b.prototype.restartClients=function(){var a=this;utils.confirm(t("IDS_WEB_NETWORK_RESTART_CLIENTS_CONFIRM"),
function(c){c&&(a.cancelPull(),utils.request("network/restart/clients",this,function(){app.pull();app.notifications.success(t("IDS_WEB_NETWORK_RESTART_CLIENTS_PROGRESS"),2E3)}))})};b.prototype.restartServer=function(){var a=this;utils.confirm(t("IDS_WEB_NETWORK_RESTART_SERVER_CONFIRM"),function(c){c&&(a.cancelPull(),utils.request("network/restart",this,function(){app.pull();app.notifications.success(t("IDS_WEB_NETWORK_RESTART_SERVER_PROGRESS"),2E3)}))})};b.prototype.restartSelected=function(){};b.prototype.restartClient=
function(){var a=this;utils.confirm(t("IDS_WEB_NETWORK_RESTART_CLIENT_CONFIRM",a.selectedItem.name),function(c){c&&(a.cancelPull(),utils.request("network/"+a.selectedItem.uuid+"/restart",this,function(){app.notifications.success(t("IDS_WEB_NETWORK_RESTART_CLIENT_PROGRESS",a.selectedItem.name),2E3);app.pull()}))})};return b}();
application.section.users=function(){function b(){application.listSection.call(this);this.verbose_name="IDS_WEB_USER";this.name="users";this.url="/users";this.formData={};this.$formDescription=this.$formIsAdmin=this.$formPassword=this.$formUsername=this.$btnDelete=this.$btnPassword=this.$btnAdd=this.$btnSave=this.$form=null;this.init()}b.prototype=Object.create(application.listSection.prototype);b.prototype.init=function(){application.listSection.prototype.init.call(this);this.$form=this.$container.find("#users_form");
this.$selectedDelete=this.$container.find(".select_action_delete");this.$btnSave=this.$container.find("#users-details_btn_save");this.$btnAdd=this.$container.find("#users-details_btn_add");this.$btnPassword=this.$container.find("#users-details_btn_password");this.$btnDelete=this.$container.find("#users-details_btn_delete");this.$controls=this.$container.find(".users-details_controls");this.$formUsername=this.$container.find("#user-details_form_username");this.$formPassword=this.$container.find("#user-details_form_password");
this.$formIsAdmin=this.$container.find("#user-details_form_isadmin");this.$formUserLanguage=this.$container.find("#user-details_form_language");this.$formDescription=this.$container.find("#user-details_form_description");this.addActions()};b.prototype.addActions=function(){var a=this;this.$formPassword.bind("keyup change",function(){a.checkForm()});this.$formIsAdmin.change(function(){a.checkForm()});this.$formUserLanguage.change(function(){a.checkForm()});this.$formDescription.bind("keyup change",
function(){a.checkForm()});this.$btnAdd.click(function(){a.addUser()});this.$btnDelete.click(function(c){c.preventDefault();a.removeUser()});this.$form.submit(function(c){c.preventDefault();a.submitUserDetails()});this.$btnPassword.click(function(){a.resetPassword()});this.$formUserLanguage.change(function(){a.setLanguage()});this.$selectedDelete.click(function(c){c.preventDefault();a.deleteSelected()})};b.prototype.checkForm=function(){var a=this.$formPassword.val(),c=this.$formIsAdmin.prop("checked"),
b=this.$formDescription.val(),e=this.formData;a!==e.password||c!==e.isadmin||b!==e.description?this.$btnSave.removeClass("disabled"):this.$btnSave.addClass("disabled")};b.prototype.updateList=function(){var a=this;this.$listPane.html("");for(var c=0;c<this.data[this.name].length;c++){var b=this.data[this.name][c],e=this.newItemFromTemplate(b,b.username,"#/users/");e.find(".type").html(b.isadmin?"<span data-trs-translate='IDS_WEB_ADMINISTRATOR'>"+t("IDS_WEB_ADMINISTRATOR")+"</span>":"<span data-trs-translate='IDS_WEB_ADMINISTRATOR'>"+
t("IDS_WEB_USER")+"</span>");app.user.uuid!==b.uuid&&e.addClass("delete_able");e.find("input").click(function(){a.setSelected()})}app.user.isadmin||this.$listPane.find("input:checkbox").hide()};b.prototype.updateDetails=function(a){application.listSection.prototype.updateDetails.call(this);this.$itemDetails.find(".panel-title").html("<span data-trs-translate='IDS_WEB_USER_DETAILS'>"+t("IDS_WEB_USER_DETAILS")+"</span>: "+a.username);this.formData.password="";this.formData.isadmin=a.isadmin;this.formData.description=
a.description;this.$formUsername.text(a.username);this.$formIsAdmin.prop("checked",a.isadmin);this.$formUserLanguage.parent().hide();this.$btnSave.addClass("disabled");if(app.user.username===this.selectedItem.username){this.$formUserLanguage.empty();for(var c=0,b=app.languages.length;c<b;c++){var e=app.languages[c];app.user&&e.extensions.toLowerCase()==app.user.language.toLowerCase()?this.$formUserLanguage.append("<option selected='selected' value='"+e.extensions+"'>"+e.name+"</option>"):this.$formUserLanguage.append("<option value='"+
e.extensions+"'>"+e.name+"</option>")}this.$formUserLanguage.parent().show()}app.user.isadmin?app.user.username===this.selectedItem.username?(this.$formDescription.parent().hide(),this.$formPassword.parent().hide(),this.$formIsAdmin.prop("disabled",!0),this.$controls.hide()):(this.$formDescription.val(a.description),this.$formDescription.parent().show(),this.$formPassword.val(""),this.$formPassword.parent().show(),this.$formIsAdmin.prop("disabled",!1),this.$controls.show()):this.$formIsAdmin.prop("disabled",
!0);app.user.username===this.selectedItem.username?this.$btnPassword.show():this.$btnPassword.hide()};b.prototype.checkVisibility=function(){app.user.isadmin?this.$btnAdd.show():(this.$selectionBtn.remove(),this.$filterField.remove(),this.$btnSave.remove(),this.$btnAdd.remove(),this.$controls.remove(),this.$formDescription.parent().remove(),this.$formPassword.parent().remove())};b.prototype.addUser=function(){var a=this,c=function(c,b,f){a.cancelPull();utils.requestPost("/users/create",{username:c,
password:$.md5(b),isadmin:f,description:""},this,function(){a.selectedItem=null;app.notifications.success(t("IDS_WEB_USER_ADD_OK",c),2E3);app.pull()})};utils.prompt(t("IDS_WEB_USER_ADD_NAME"),function(b){if(null!==b){var e=$.trim(b);if(0===e.length)app.notifications.danger(t("IDS_WEB_USER_ADD_NAME_EMPTY"));else if(e.match(/^[a-zA-Z0-9_.-]+$/)){for(b=0;b<a.data.users.length;b++)if(utils.cutdown(a.data.users[b].username)===utils.cutdown(e)){app.notifications.danger(t("IDS_WEB_USER_ADD_NAME_EXISTS",
e));return}utils.prompt(t("IDS_WEB_USER_ADD_PWD",e),function(a){null!==a&&(0===a.length?app.notifications.danger(t("IDS_WEB_USER_PWD_EMPTY")):bootbox.dialog({message:t("IDS_WEB_USER_ADD_ADMIN",e),buttons:{cancel:{label:t("IDS_WEB_CANCEL"),className:"btn-default"},danger:{label:t("IDS_WEB_POS"),className:"btn-danger",callback:function(){c(e,a,!0)}},main:{label:t("IDS_WEB_NEG"),className:"btn-primary",callback:function(){c(e,a,!1)}}}}))})}else app.notifications.danger(t("IDS_WEB_USER_ADD_NAME_ILLEGAL"))}})};
b.prototype.removeUser=function(){var a=this;utils.confirm(t("IDS_WEB_USER_DEL",this.selectedItem.username),function(c){if(c){var b=a.selectedItem.username;a.cancelPull(!0);a.disableDetails();utils.request("/users/"+a.selectedItem.uuid+"/delete",this,function(){app.notifications.success(t("IDS_WEB_USER_DEL_OK",b),2E3);app.pull()})}})};b.prototype.submitUserDetails=function(){var a=this;utils.confirm(t("IDS_WEB_USER_EDIT_CONFIRM",a.selectedItem.username),function(c){if(c){c=void 0;a.$formPassword.val()!==
a.formData.password&&""!==a.$formPassword.val()&&(c=$.md5(a.$formPassword.val()));var b=void 0;a.$formIsAdmin.prop("checked")!==a.formData.isadmin&&(b=a.$formIsAdmin.is(":checked"));var e=void 0;a.$formDescription.val()!==a.formData.description&&(e=a.$formDescription.val());utils.requestPost("/users/edit",{useruuid:a.selectedItem.uuid,newpassword:c,newisadmin:b,newdescription:e},this,function(){app.notifications.success(t("IDS_WEB_USER_EDIT_CHANGED",a.selectedItem.username),2E3);app.pull()})}})};
b.prototype.resetPassword=function(){utils.prompt(t("IDS_WEB_USER_CHANGE_PWD_OLD"),function(a){null!=a&&(0===a.length?app.notifications.danger(t("IDS_WEB_USER_CHANGE_PWD_MTY")):utils.requestPost("/settings/password/verify",{password:$.md5(a)},this,function(c){c.result?utils.prompt(t("IDS_WEB_USER_CHANGE_PWD_NEW"),function(c){null!=c&&(0===c.length?app.notifications.danger(t("IDS_WEB_USER_CHANGE_PWD_MTY")):utils.prompt(t("IDS_WEB_USER_CHANGE_PWD_NEW_2"),function(b){null!=b&&(b!==c?app.notifications.danger(t("IDS_WEB_USER_CHANGE_PWD_NOK")):
utils.confirm(t("IDS_WEB_USER_CHANGE_PWD_SAVE"),function(b){b&&utils.requestPost("/settings/password/set",{useruuid:app.user.uuid,oldpassword:$.md5(a),newpassword:$.md5(c)},this,function(){app.pull();app.notifications.success(t("IDS_WEB_USER_CHANGE_PWD_OK"),2E3)})}))}))}):app.notifications.danger(t("IDS_WEB_WRONG_PASSWORD"))}))})};b.prototype.setLanguage=function(){var a=this.$formUserLanguage.val();utils.requestPost("/settings/language/set",{language:this.$formUserLanguage.val()},this,function(c){app.user.language=
a;app.lang=c.labels;null==app.lang_default&&(app.lang_default=app.lang);app.storeSession();window.location.reload()})};b.prototype.deleteSelected=function(){var a=this;if(0!==this.selected.length){var c=[],b="";this.$listPane.find(".delete_able").each(function(e){e=$(this).find("a:first");var g=e.attr("href"),g=g.substring(g.lastIndexOf("/")+1);-1<a.selected.indexOf(g)&&(b=e.text(),g===app.user.uuid?app.notifications.danger(t("IDS_WEB_USER_DEL_SELF")):c.push(g))});if(0!=c.length){var e=1<c.length?
t("IDS_WEB_USER_DEL_SELECTED_MULTIPLE"):t("IDS_WEB_USER_DEL",b);utils.confirm(e,function(e){if(e){e=[];for(var g=0;g<c.length;g++)a.disableItem(c[g]),e.push(utils.request("/users/"+c[g]+"/delete"));a.disableDetails();a.cancelPull(!0);$.when(e).then(function(a){a=1<c.length?t("IDS_WEB_USER_DEL_OK_MULTIPLE"):t("IDS_WEB_USER_DEL_OK",b);app.notifications.success(a,2E3);app.pull()})}})}}};return b}();
application.section.monitor=function(){function b(){application.ajaxSection.call(this);this.verbose_name="IDS_WEB_MONITOR";this.name="monitor";this.url="/monitor";this.$noJobs=this.$warning=this.drive=this.$networksTable=this.$jobsTable=null;this.init()}b.prototype=Object.create(application.ajaxSection.prototype);b.prototype.init=function(){application.ajaxSection.prototype.init.call(this);this.templates.$rowJobItem=$("#monitor_jobtable_row-template table tbody");this.templates.$rowNetworkItem=$("#monitor_networktable_row-template table tbody");
this.$jobsTable=this.$container.find("#table-jobs");this.$networksTable=this.$container.find("#table-network");this.$noJobs=this.$container.find(".alert-no-jobs");var a=this;this.updateControls();this.checkVisibility();this.$container.find('a[data-toggle="pill"]').bind("shown.bs.tab",function(c){a.url="/"+$(c.target).attr("target");a.pull();a.updateControls()})};b.prototype.update=function(){var a=this;this.$jobsTable.find("tbody tr").remove();0==this.data.jobs.length?(this.$noJobs.show(),this.$jobsTable.hide()):
(this.$noJobs.hide(),this.$jobsTable.show());for(var c=0;c<this.data.jobs.length;c++){var b=this.data.jobs[c],e=utils.getJobContextualColor(b),f=$(this.templates.$rowJobItem.html());e&&f.addClass(e);var g=f.find("a");g.text(b.name);g.data("uuid",b.uuid);g.attr("href","#/jobs/"+b.uuid);g.attr("id","joblink-"+b.uuid);g.click(function(a,c){return function(c){app.sections.jobs.selectedItem=a;app.gotoSection(app.sections.jobs.name)}}(b,this));$btnStart=$("<a class='btn btn-primary btn-xs'><i class='glyphicon glyphicon-play'></i></a>");
$btnStop=$("<a class='btn btn-primary btn-xs'><i class='glyphicon glyphicon-stop'></i></a>");$btnClearResults=$("<a class='btn btn-danger btn-xs'><i class='glyphicon glyphicon-trash'></i></a>");$(f.find("td.cell-position")).find(".position").text(0<=b.id?b.id:"");$(f.find("td.cell-scene")).text(b.defaultscenename);$(f.find("td.cell-user")).text(b.user);$(f.find("td.cell-created")).text(b.datetime_create);$(f.find("td.cell-started")).text(""===b.datetime_start?"---":b.datetime_start);$(f.find("td.cell-clients")).text(b.involvedmachines);
f.find(".badge").text(t("IDS_WEB_JOB_"+b.statusshort.toUpperCase()));g=f.find(".progress-bar");g.parent().removeClass();g.parent().addClass("progress");g.removeClass();g.addClass("progress-bar");"info"===e?(g.parent().addClass("active"),g.parent().addClass("progress-striped"),$(f.find("td.cell-action")).append($btnStop),$btnStop.click(function(c,b){return function(){a.toggleJob(c,b)}}(b,!1))):e&&g.addClass("progress-bar-"+e);"info"!=e&&"success"!=e&&""!==b.defaultscenename?($(f.find("td.cell-action")).append($btnStart),
$btnStart.click(function(c,b){return function(){a.toggleJob(c,b)}}(b,!0))):"success"===e&&($(f.find("td.cell-action")).append($btnClearResults),$btnClearResults.click(function(c,b){return function(){a.clearAllResults(c)}}(b,!1)));g.css("width",b.progressgui+"%");g.find(".percentage").text(b.progressgui);this.$jobsTable.append(f)}a.$jobsTable.find("tbody").sortable({items:"tr.info",helper:function(a,c){var b=c.find("td"),d=c.clone();d.find("td").each(function(a){$(this).width(b.eq(a).outerWidth())});
return d},start:function(){a.holdUpdate=!0},stop:function(c,b){a.holdUpdate=!1;var d=$(b.item),e=d.find("a").attr("href").substring(d.find("a").attr("href").lastIndexOf("/")+1),f=null,f=null;0<d.next().length?(f=d.next().find("a").attr("href").substring(d.next().find("a").attr("href").lastIndexOf("/")+1),utils.request("/jobs/"+e+"/move?insertbefore="+f,this,app.pull)):0<d.prev().length&&(f=d.prev().find("a").attr("href").substring(d.prev().find("a").attr("href").lastIndexOf("/")+1),utils.request("/jobs/"+
e+"/move?insertafter="+f,this,app.pull))}});this.$jobsTable.bind("sortEnd",function(c){c=a.$jobsTable.find(".tablesorter-headerAsc");0==$(c).index()&&1<$("tr.info").length?(a.$jobsTable.addClass("jobs-sortable"),a.$jobsTable.find("tr.info").bind("mousedown",function(){0==$(this).index()?a.$jobsTable.find("tbody").sortable("disable"):a.$jobsTable.find("tbody").sortable("enable")})):a.$jobsTable.removeClass("jobs-sortable")});this.$networksTable.find("tbody tr").remove();for(c=0;c<this.data.network.length;c++)b=
this.data.network[c],f=$(this.templates.$rowNetworkItem.html()),e=utils.getMachineContextualColor(b),f.addClass(e),e=0,b.islocal?(g=$(f.find("td.cell-selected")),g.find("input").toggleClass("hidden"),g.find("span").toggleClass("hidden")):$(f.find("td.cell-selected")).find("input").prop("checked",b.selected),$(f.find("td.cell-description")).text(b.description),g=f.find(".cell-machinename a"),g.text(b.name),g.data("uuid",b.uuid),g.attr("href","#/networks/"+b.uuid),g.attr("id","machinelink-"+b.uuid),
g.click(function(a,c){return function(c){c.preventDefault();app.sections.network.selectedItem=a;app.sections.network.selectedItemFirst=!0;app.gotoSection(app.sections.network.name)}}(b,this)),e++,$(f.find("td.cell-os")).text(b.os),$(f.find("td.cell-status")).text(t("IDS_WEB_NETWORK_"+b.statusshort.toUpperCase())),e=b.current_framestart,"busy"==b.statusshort&&0<=e&&(e=b.current_framestart,g=b.current_frameend,e==g?$(f.find("td.cell-rendering")).text(b.current_job+" ["+e+"]"):$(f.find("td.cell-rendering")).text(b.current_job+
" ["+e+" - "+g+"]")),this.$networksTable.append(f);c=this.$container.find(".table");c.trigger("update");c.trigger("search",!1)};b.prototype.resize=function(){if(utils.testMediaBreakPoint("lg")){this.$container.find(".tab-pane").addClass("active");var a=$(window).height()-$("#footer").height()-$("#navigation").find(".navbar ").height(),a=a-100;this.$container.find(".table-container").css("max-height",a+"px");this.$container.find(".table-container").css("overflow","auto");this.$container.css("padding-bottom",
"0px")}else this.$container.find(".table-container").css("height","100%"),this.$container.css("padding-bottom","60px")};b.prototype.updateControls=function(){var a=this.$container.find(".btn-group-filter");scope=this;for(var c=0;c<a.length;c++){field=a[c];$item=$(field);var b=scope.$container.find($item.data("filter-for")),e=$item.find(".column-selector .dropdown-menu"),f=$item.find(".filter"),g=e.find("[data-value='all']");e.find("[data-value!='all']").parents("li").remove();$item.find(".column-selector button .text").text(g.text());
f.val("");f.attr("data-column",g.data("value"));b.find("th").each(function(a){$(this).hasClass("filterable")&&e.append("<li><a href='javascript:void(0)' data-value='"+a+"'>"+$(this).find("span").text()+"</a></li>")});b.tablesorter({sortReset:!0,widthFixed:!0,sortList:[[0,0]],widgets:["saveSort","filter"],widgetOptions:{filter_hideFilters:!1,filter_anyMatch:!1,filter_columnFilters:!1,filter_external:f,filter_searchDelay:0}});b.trigger("update");b.trigger("search",!1)}this.addActions()};b.prototype.addActions=
function(){var a=this;this.$columnSelectors=this.$container.find(".column-selector li a");this.$columnSelectors.click(function(){$this=$(this);$group=$this.parents(".btn-group-filter");var c=$this.data("value");$group.find(".filter").attr("data-column",c);$group.find(".column-selector button .text").text($this.text());a.$container.find($group.data("filter-for")).trigger("search",!1)});this.$container.find("[data-toggle=toggle-tab]").on("click",function(c){c.preventDefault();$this=$(this);href=$this.attr("href");
$this.toggleClass("active");$(href).toggle($this.hasClass("active"));active=a.$container.find(".tab-content .tab-pane.active:visible");1===active.length?active.removeClass("col-lg-6"):active.addClass("col-lg-6")})};b.prototype.pull=function(){this.cancelPull();app.spin(!0);var a="",a=this.selectedItem?this.selectedItem.uuid:"00000000-0000-0000-0000-000000000001",c=enums.DETAILSELECTOR_NONE;this.requestHandler=utils.request(this.url+"?assets="+enums.DETAILSELECTOR_SELECTED+"&results="+c+"&log="+c+
"&rdata="+c+"&rgroups="+c+"&jobid="+a,this,[this.setData,this.lazyUpdate],this.pullError)};b.prototype.toggleJob=function(a,c){var b=this;c?(b.cancelPull(!0),app.notifications.success(t("IDS_WEB_JOB_STARTING",a.name),2E3),utils.request("/jobs/"+a.uuid+"/start",this,app.pull)):utils.confirm(t("IDS_WEB_JOB_STOP_CONFIRM",a.name),function(c){c&&(b.cancelPull(!0),app.notifications.success(t("IDS_WEB_JOB_STOPPING",a.name),2E3),utils.request("/jobs/"+a.uuid+"/stop",this,app.pull))})};b.prototype.clearAllResults=
function(a){utils.confirm(t("IDS_WEB_JOB_RESULT_CLEAR_ALL"),function(c){c&&(app.notifications.success(t("IDS_WEB_JOB_RESULT_CLEAR_ALL_PROCESS",a.name),2E3),utils.request("/jobs/"+a.uuid+"/clear",app,app.pull))})};b.prototype.checkVisibility=function(){};return b}();
utilities=function(){function b(){window.utils?utils.log("'utilities' can only be initialized once!"):window.utils=this;window.t=this.getTranslatedStringFromID;jQuery.fn.exists=function(){return 0<this.length}}b.prototype.log=function(a,c){(app.config.debug||c)&&console.log(a)};b.prototype.request=function(a,c,d,e,f){return b.prototype.ajaxRequest(a,null,c,"GET",d,e,f)};b.prototype.requestPost=function(a,c,d,e,f,g){return b.prototype.ajaxRequest(a,c,d,"POST",e,f,g)};b.prototype.ajaxRequest=function(a,
c,b,e,f,g,h){var l=function(c,b,d){if("abort"!==c.statusText){var e=!1;401===c.status?app.user&&(e=!0,app.killSession(!1),utils.alert(t("IDS_WEB_SESSION_LOST"),function(){window.location.reload()})):g||utils.throwHTTPError(c,b,d,a);g&&!e&&g(c,b,d,a)}};return $.ajax({timeout:app.config.timeout,url:a,type:e||"POST",data:c,datatype:"json",success:function(a){if("[object Array]"===Object.prototype.toString.call(f))for(var c=0;c<f.length;c++)"function"===typeof f[c]&&f[c].call(b,a);else"function"===typeof f&&
f.call(b,a)},fail:l,error:l,cache:void 0===h?!1:h.cache})};b.prototype.throwHTTPError=function(a,c,b,e){c="";a.responseJSON&&a.responseJSON.error?c=a.responseJSON.error:a.responseText&&(c=a.responseText);b="";b=app.config.debug||0!==a.status&&404!==a.status?"ERROR: ("+a.status+") :"+utils.HTML2Text(c)+" ("+e+")":t("IDS_WEB_NOCON");app.notifications.danger(b,.75*app.config.timer);utils.log(b)};b.prototype.getCurrentHashWithoutParams=function(a){(a=location.hash.match(/#\/[a-zA-Z0-9]*/))&&0<a.length&&
(a=a[0].substr(2));return a?utils.cutdown(a):null};b.prototype.setCookie=function(a,c,b){if(b){var e=new Date;e.setTime(e.getTime()+864E5*b);b="; expires="+e.toGMTString()}else b="";document.cookie=app.config.cookiePrefix+a+"="+c+b+"; path=/"};b.prototype.getCookie=function(a){a=app.config.cookiePrefix+a+"=";for(var c=document.cookie.split(";"),b=0;b<c.length;b++){for(var e=c[b];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(a))return e.substring(a.length,e.length)}return null};b.prototype.removeCookie=
function(a){this.setCookie(a,"",null)};b.prototype.translateElements=function(a){if(app.lang&&a&&(a=a.find("[data-trs-translate]"),0<a.length))for(var c=0,b=a.length;c<b;c++){var e=$(a[c]);try{var f=e.data("trs-translate");value=app.lang[f];"undefined"===typeof value&&(value=app.lang_default[f],"undefined"===typeof value&&(value="localization unavailable: "+f))}catch(g){value="replace content error: "+g.message}e.attr("placeholder")?e.attr("placeholder",value):(e.empty(),e.append(value))}};b.prototype.getTranslatedStringFromID=
function(a){if(app.lang&&a){value=app.lang[a];if(!value&&(value=app.lang_default[a],!value))return"localization unavailable: "+a;for(var c=1,b=arguments.length;c<b;c++)value=value.replace("#",arguments[c]);return value}};b.prototype.alert=function(a,c){this.confirm(a,c);$(".modal-dialog .btn-default").hide()};b.prototype.prompt=function(a,c){bootbox.prompt(a,c);$(".modal-dialog .btn-primary").text(t("IDS_WEB_POS"));$(".modal-dialog .btn-default").text(t("IDS_WEB_CANCEL"))};b.prototype.confirm=function(a,
c){bootbox.confirm(a,c);$(".modal-dialog .btn-primary").text(t("IDS_WEB_POS"));$(".modal-dialog .btn-default").text(t("IDS_WEB_CANCEL"))};b.prototype.endsWith=function(a,c){var b=a.indexOf(c);return a.substr(b,a.length-b)===c};b.prototype.getJobContextualColor=function(a){return"idle"===a.statusshort?null:"stopped"===a.statusshort?"warning":"failed"===a.statusshort?"danger":"complete"===a.statusshort?"success":"info"};b.prototype.getMachineContextualColor=function(a){if("idle"===a.statusshort)return"";
if("busy"===a.statusshort)return"success";if("offline"===a.statusshort)return"danger"};b.prototype.msToStr=function(a){var c="";a=Math.floor(a/1E3);var b=Math.floor((a%=31536E3)/86400);b&&(c+=b+" "+(1===b?t("IDS_WEB_DAY"):t("IDS_WEB_DAYS"))+" ");(b=Math.floor((a%=86400)/3600))&&(c+=b+" "+(1===b?t("IDS_WEB_HOUR"):t("IDS_WEB_HOURS"))+" ");(b=Math.floor((a%=3600)/60))&&(c+=b+" "+(1===b?t("IDS_WEB_MINUTE"):t("IDS_WEB_MINUTES"))+" ");(a%=60)&&(c+=a+" "+(1===a?t("IDS_WEB_SECOND"):t("IDS_WEB_SECONDS"))+
" ");return 0<c.length?c:t("IDS_WEB_NOW")};b.prototype.memoryToString=function(a){return 0<=a&&1024>a?a+" B":1024<=a&&1048576>a?(a/1024).toFixed(2)+" KB":1048576<=a&&1073741824>a?(a/1048576).toFixed(2)+" MB":1073741824<=a&&1099511627776>a?(a/1073741824).toFixed(2)+" GB":(a/1099511627776).toFixed(2)+" TB"};b.prototype.capitalizeFirstChar=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};b.prototype.cutdown=function(a){return $.trim(a.toLowerCase())};b.prototype.HTML2Text=function(a){return $("<div></div>").text(a).text()};
b.prototype.testMediaBreakPoint=function(a){return 0!=$(".device-"+a+":visible").length};return b}();$(document).ready(function(){new utilities;new application});
enums={DTYPE_NONE:0,DTYPE_CHILDREN:0,DTYPE_GROUP:1,DTYPE_COLOR:3,DTYPE_SUBCONTAINER:5,DTYPE_MULTIPLEDATA:6,DTYPE_TEXTURE:7,DTYPE_BUTTON:8,DTYPE_DYNAMIC:10,DTYPE_SEPARATOR:11,DTYPE_STATICTEXT:12,DTYPE_POPUP:13,DTYPE_LONG:15,DTYPE_REAL:19,DTYPE_TIME:22,DTYPE_VECTOR:23,DTYPE_MATRIX:25,DTYPE_STRING:130,DTYPE_FILENAME:131,DTYPE_BASELISTLINK:133,DTYPE_BOOL:400006001,DTYPE_NORMAL:400006005,DESCID_ROOT:1000491,DETAILSELECTOR_NONE:0,DETAILSELECTOR_SELECTED:1,DETAILSELECTOR_NONSELECTED:2,RDATA_SIZEUNIT_PIXELS:0,
RDATA_SIZEUNIT_CM:1,RDATA_SIZEUNIT_MM:2,RDATA_SIZEUNIT_INCHES:3,RDATA_SIZEUNIT_POINTS:4,RDATA_SIZEUNIT_PICAS:5,DISABLE:0,ENABLE:1};
//# sourceMappingURL=/js/trwi.min.js.map